#:kivy 1.11
#:import Graph kivy.garden.graph.Graph

<ChaosPlotter>:
    graph: graph
    diagram: diag_label
    r_slider: r_factor
    progress: progress_bar

    BoxLayout:
        orientation: "vertical"
        spacing: 10
        size: root.size
        RelativeLayout:
            orientation: "horizontal"
            size_hint: 1.0, 0.05
            Spinner:
                pos_hint: {'x': 0}
                size_hint_x: 0.2
                values: ["R * P * (1 - P)", "R * sin(P)", "R * sin(P)^2", "R * P * P * (1-P)", "R * P * (1 - P*P)"]
                on_text: root.function_index = self.values.index(self.text)
            Spinner:
                #size_hint: 0.2, 0.05
                pos_hint: {'right': 1}
                size_hint_x: 0.2
                text: "Population"
                values: ["Population", "Fourier", "Population diff", "Fourier od diff"]
        BoxLayout:
            orientation: "horizontal"
            size_hint: 1.0, 0.2
            pos_hint: {'x': 0.0}
            
            BoxLayout:
                orientation: "vertical"
                size_hint: 0.05, 1.0
                TickSlider:
                    id: population_start
                    sensitivity: "handle"
                    orientation: "vertical"
                    min: 0
                    max: 1
                    step: 0.01
                    value: root.population
                    size_hint: 1.0, 0.84
                    pos_hint: {'x': 0.0}
                    on_value: root.population = self.value
                    ticks_major: 1
                    ticks_minor: 5
                
                Label:
                    text: "P = {:.2f}".format(population_start.value)
                    size_hint: 1.0, 0.16
                    font_size: 18

            Graph:
                id: graph
                xlabel: 'Iterations'
                ylabel: 'Population'
                x_ticks_minor: 5
                x_ticks_major: 25
                y_ticks_major: 0.1
                y_grid_label: True
                x_grid_label: True
                padding: 5
                x_grid: True
                y_grid: True
                xmin: 0
                xmax: 1000
                ymin: 0
                ymax: 1
                size_hint: 0.95, 1.0
        
        Label:
            text_size: self.size
            size_hint: 1.0, 0.03
            text: "R = {:.3f}".format(r_factor.value)
            halign: "left"
            font_size: 18
            padding_x: [10, 0]

        TickSlider:
            size_hint: 1.02, 0.03
            pos_hint: {'x': -0.01}
            id: r_factor
            orientation: "horizontal"
            sensitivity: "handle"
            min: 1
            max: 4
            step: 0.001
            value: root.r
            on_value: root.r = self.value
            ticks_major: 1
            ticks_minor: 5
            value_track: True
            value_track_color: 0.2, 0.71, 0.9, 1.0
        
        BoxLayout:
            size_hint: 1.0, 0.6
            
            Label:
                id: diag_label
                size_hint: 1.0, 1.0
                on_size: root.diag_size = self.size
                canvas.before:
                    Color:
                        rgba: 1, 1, 1, 1
                    Rectangle:
                        size: self.size
                        pos: self.pos
        BoxLayout: 
            size_hint: 1.0, 0.02
            ProgressBar:
                id: progress_bar
                size_hint_x: 1.0
                size_x: 20
                pos_y: root.center_y
